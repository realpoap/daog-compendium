// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

generator zod {
  provider         = "zod-prisma-types"
  output           = "../src/lib/zod-prisma"
  useMultipleFiles = false
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  email     String   @unique
  name      String
  password  String   @unique
  isOwner   Boolean  @default(false)
  role      Role     @default(VIEWER)
  createdAt DateTime @default(now())

  @@unique([name, password])
}

enum Role {
  VIEWER
  EDITOR
  ADMIN
}

model Creature {
  id          String              @id @default(auto()) @map("_id") @db.ObjectId
  fullname    String              @unique
  name        String
  rank        String?
  type        String
  subtype     String?
  size        CreatureSize
  createdAd   DateTime?           @default(now())
  updatedAt   DateTime?           @updatedAt
  level       Int
  attack      Int
  defense     Int
  ranged      Int
  health      Int
  armor       Int?
  perception  Int?
  magic       Int?
  spirit      Int?
  stats       StatProfil?
  loot        String[]
  objects     String[]
  actionList  ActionList?
  attributes  CreatureAttribute[]
  flavor      String?
  description String?
  actions     CreatureActions[]
}

model CreatureAttribute {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  name        String    @unique
  flavor      String?
  Description String?
  Creature    Creature? @relation(fields: [creatureId], references: [id])
  creatureId  String?   @db.ObjectId
}

model ActionList {
  id         String    @id @default(auto()) @map("_id") @db.ObjectId
  main       Int
  limited    Int
  free       Int
  travel     Int
  creature   Creature? @relation(fields: [creatureId], references: [id])
  creatureId String?   @unique @db.ObjectId
}

model CreatureActions {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  action      ActionType
  type        String
  flavor      String?
  description String
  damages     String?
  effects     String?
  heal        String?
  target      String?
  range       String?
  creature    Creature?  @relation(fields: [creatureId], references: [id])
  creatureId  String?    @db.ObjectId
}

enum ActionType {
  main
  limited
  free
}

enum CreatureSize {
  tiny
  small
  average
  large
  huge
  gigantic
}

model StatProfil {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  CEL Int
  AGI Int
  DEX Int
  STR Int
  END Int
  VIT Int
  COU Int
  INS Int
  SEN Int
  CHA Int
  SOC Int
  ERU Int
  creature    Creature?  @relation(fields: [creatureId], references: [id])
  creatureId  String?    @db.ObjectId @unique
}

model Spell {
  id          String        @id @default(auto()) @map("_id") @db.ObjectId
  number      Int           @unique
  titleGlaise String?
  titleCommon String
  createdAt   DateTime?     @default(now())
  updatedAt   DateTime?     @updatedAt
  level       Int
  type        SpellType
  cost        Int
  difficulty  Int
  casting     SpellCasting?
  targetType  SpellTarget?
  action      SpellAction?
  flavor      String?
  description String
  damages     String?
  heal        String?
  effects     String?
  range       String?
  duration    String?
  target      String?
  components  String?
}

model Component {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  quantity    Float?
  name        String   @unique
  description String?
  weight      Float?
  value       Float?
  rarity      String?
  spells      String[]
}

enum SpellType {
  mouflette
  beast
  nature
  scourge
  spirit
  death
  life
  earth
  fire
  water
  air
  blood
}

enum SpellAction {
  charm
  damage
  heal
  protect
  enhance
  link
  create
  transform
  move
  remove
  puzzle
}

enum SpellCasting {
  instant
  delayed
  ritual
  concentration
  upkeep
}

enum SpellTarget {
  single
  multiple
  random
  self
  none
}
